{"name": "test_retrieve_document_with_permission", "status": "broken", "statusDetails": {"message": "django.db.utils.IntegrityError: null value in column \"last_editor_id\" of relation \"knowledge_knowledgedocument\" violates not-null constraint\nDETAIL:  Failing row contains (6, 私有文档, 这是私有文档内容, null, document, draft, , 0, 0, f, t, 2025-07-28 08:45:57.661919+00, 2025-07-28 08:45:57.661941+00, null, 43, null, 15, null).", "trace": "self = <django.db.backends.utils.CursorWrapper object at 0x10a7cb5f0>\nsql = 'INSERT INTO \"knowledge_knowledgedocument\" (\"title\", \"content\", \"summary\", \"doc_type\", \"status\", \"namespace_id\", \"pare...LUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s) RETURNING \"knowledge_knowledgedocument\".\"id\"'\nparams = ('私有文档', '这是私有文档内容', None, 'document', 'draft', 15, ...)\nignored_wrapper_args = (False, {'connection': <DatabaseWrapper vendor='postgresql' alias='default'>, 'cursor': <django.db.backends.utils.CursorWrapper object at 0x10a7cb5f0>})\n\n    def _execute(self, sql, params, *ignored_wrapper_args):\n        # Raise a warning during app initialization (stored_app_configs is only\n        # ever set during testing).\n        if not apps.ready and not apps.stored_app_configs:\n            warnings.warn(self.APPS_NOT_READY_WARNING_MSG, category=RuntimeWarning)\n        self.db.validate_no_broken_transaction()\n        with self.db.wrap_database_errors:\n            if params is None:\n                # params default might be backend specific.\n                return self.cursor.execute(sql)\n            else:\n>               return self.cursor.execute(sql, params)\nE               psycopg2.errors.NotNullViolation: null value in column \"last_editor_id\" of relation \"knowledge_knowledgedocument\" violates not-null constraint\nE               DETAIL:  Failing row contains (6, 私有文档, 这是私有文档内容, null, document, draft, , 0, 0, f, t, 2025-07-28 08:45:57.661919+00, 2025-07-28 08:45:57.661941+00, null, 43, null, 15, null).\n\n/opt/anaconda3/lib/python3.12/site-packages/django/db/backends/utils.py:105: NotNullViolation\n\nThe above exception was the direct cause of the following exception:\n\nself = <knowledge.tests.test_knowledge_management.KnowledgeDocumentTestCase testMethod=test_retrieve_document_with_permission>\n\n    def test_retrieve_document_with_permission(self):\n        \"\"\"测试获取文档详情和权限检查\"\"\"\n>       document = KnowledgeDocument.objects.create(\n            title='私有文档',\n            content='这是私有文档内容',\n            doc_type='document',\n            namespace=self.namespace,\n            creator=self.user1,\n            is_public=False\n        )\n\nknowledge/tests/test_knowledge_management.py:401: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/anaconda3/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method\n    return getattr(self.get_queryset(), name)(*args, **kwargs)\n/opt/anaconda3/lib/python3.12/site-packages/django/db/models/query.py:663: in create\n    obj.save(force_insert=True, using=self.db)\nknowledge/models/knowledge_management.py:271: in save\n    super().save(*args, **kwargs)\n/opt/anaconda3/lib/python3.12/site-packages/django/db/models/base.py:902: in save\n    self.save_base(\n/opt/anaconda3/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base\n    updated = self._save_table(\n/opt/anaconda3/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table\n    results = self._do_insert(\n/opt/anaconda3/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert\n    return manager._insert(\n/opt/anaconda3/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method\n    return getattr(self.get_queryset(), name)(*args, **kwargs)\n/opt/anaconda3/lib/python3.12/site-packages/django/db/models/query.py:1868: in _insert\n    return query.get_compiler(using=using).execute_sql(returning_fields)\n/opt/anaconda3/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql\n    cursor.execute(sql, params)\n/opt/anaconda3/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute\n    return self._execute_with_wrappers(\n/opt/anaconda3/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers\n    return executor(sql, params, many, context)\n/opt/anaconda3/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute\n    with self.db.wrap_database_errors:\n/opt/anaconda3/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__\n    raise dj_exc_value.with_traceback(traceback) from exc_value\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <django.db.backends.utils.CursorWrapper object at 0x10a7cb5f0>\nsql = 'INSERT INTO \"knowledge_knowledgedocument\" (\"title\", \"content\", \"summary\", \"doc_type\", \"status\", \"namespace_id\", \"pare...LUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s) RETURNING \"knowledge_knowledgedocument\".\"id\"'\nparams = ('私有文档', '这是私有文档内容', None, 'document', 'draft', 15, ...)\nignored_wrapper_args = (False, {'connection': <DatabaseWrapper vendor='postgresql' alias='default'>, 'cursor': <django.db.backends.utils.CursorWrapper object at 0x10a7cb5f0>})\n\n    def _execute(self, sql, params, *ignored_wrapper_args):\n        # Raise a warning during app initialization (stored_app_configs is only\n        # ever set during testing).\n        if not apps.ready and not apps.stored_app_configs:\n            warnings.warn(self.APPS_NOT_READY_WARNING_MSG, category=RuntimeWarning)\n        self.db.validate_no_broken_transaction()\n        with self.db.wrap_database_errors:\n            if params is None:\n                # params default might be backend specific.\n                return self.cursor.execute(sql)\n            else:\n>               return self.cursor.execute(sql, params)\nE               django.db.utils.IntegrityError: null value in column \"last_editor_id\" of relation \"knowledge_knowledgedocument\" violates not-null constraint\nE               DETAIL:  Failing row contains (6, 私有文档, 这是私有文档内容, null, document, draft, , 0, 0, f, t, 2025-07-28 08:45:57.661919+00, 2025-07-28 08:45:57.661941+00, null, 43, null, 15, null).\n\n/opt/anaconda3/lib/python3.12/site-packages/django/db/backends/utils.py:105: IntegrityError"}, "description": "测试获取文档详情和权限检查", "start": 1753692356928, "stop": 1753692357763, "uuid": "0e0354cb-9874-484f-a45a-613614fc867e", "historyId": "879b1eb62c59b8aef147c3fff8cb1e4f", "testCaseId": "879b1eb62c59b8aef147c3fff8cb1e4f", "fullName": "knowledge.tests.test_knowledge_management.KnowledgeDocumentTestCase#test_retrieve_document_with_permission", "labels": [{"name": "tag", "value": "django_db"}, {"name": "parentSuite", "value": "knowledge.tests"}, {"name": "suite", "value": "test_knowledge_management"}, {"name": "subSuite", "value": "KnowledgeDocumentTestCase"}, {"name": "host", "value": "zongjunyi.local"}, {"name": "thread", "value": "49126-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "knowledge.tests.test_knowledge_management"}]}