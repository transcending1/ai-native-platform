{"name": "test_delete_document_recursive", "status": "broken", "statusDetails": {"message": "django.db.utils.IntegrityError: null value in column \"last_editor_id\" of relation \"knowledge_knowledgedocument\" violates not-null constraint\nDETAIL:  Failing row contains (2, 文件夹, null, null, folder, draft, , 0, 0, f, t, 2025-07-28 08:45:53.829413+00, 2025-07-28 08:45:53.82944+00, null, 31, null, 11, null).", "trace": "self = <django.db.backends.utils.CursorWrapper object at 0x10a791280>\nsql = 'INSERT INTO \"knowledge_knowledgedocument\" (\"title\", \"content\", \"summary\", \"doc_type\", \"status\", \"namespace_id\", \"pare...LUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s) RETURNING \"knowledge_knowledgedocument\".\"id\"'\nparams = ('文件夹', None, None, 'folder', 'draft', 11, ...)\nignored_wrapper_args = (False, {'connection': <DatabaseWrapper vendor='postgresql' alias='default'>, 'cursor': <django.db.backends.utils.CursorWrapper object at 0x10a791280>})\n\n    def _execute(self, sql, params, *ignored_wrapper_args):\n        # Raise a warning during app initialization (stored_app_configs is only\n        # ever set during testing).\n        if not apps.ready and not apps.stored_app_configs:\n            warnings.warn(self.APPS_NOT_READY_WARNING_MSG, category=RuntimeWarning)\n        self.db.validate_no_broken_transaction()\n        with self.db.wrap_database_errors:\n            if params is None:\n                # params default might be backend specific.\n                return self.cursor.execute(sql)\n            else:\n>               return self.cursor.execute(sql, params)\nE               psycopg2.errors.NotNullViolation: null value in column \"last_editor_id\" of relation \"knowledge_knowledgedocument\" violates not-null constraint\nE               DETAIL:  Failing row contains (2, 文件夹, null, null, folder, draft, , 0, 0, f, t, 2025-07-28 08:45:53.829413+00, 2025-07-28 08:45:53.82944+00, null, 31, null, 11, null).\n\n/opt/anaconda3/lib/python3.12/site-packages/django/db/backends/utils.py:105: NotNullViolation\n\nThe above exception was the direct cause of the following exception:\n\nself = <knowledge.tests.test_knowledge_management.KnowledgeDocumentTestCase testMethod=test_delete_document_recursive>\n\n    def test_delete_document_recursive(self):\n        \"\"\"测试递归删除文档\"\"\"\n        # 创建层次结构\n>       folder = KnowledgeDocument.objects.create(\n            title='文件夹',\n            doc_type='folder',\n            namespace=self.namespace,\n            creator=self.user1\n        )\n\nknowledge/tests/test_knowledge_management.py:473: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/anaconda3/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method\n    return getattr(self.get_queryset(), name)(*args, **kwargs)\n/opt/anaconda3/lib/python3.12/site-packages/django/db/models/query.py:663: in create\n    obj.save(force_insert=True, using=self.db)\nknowledge/models/knowledge_management.py:271: in save\n    super().save(*args, **kwargs)\n/opt/anaconda3/lib/python3.12/site-packages/django/db/models/base.py:902: in save\n    self.save_base(\n/opt/anaconda3/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base\n    updated = self._save_table(\n/opt/anaconda3/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table\n    results = self._do_insert(\n/opt/anaconda3/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert\n    return manager._insert(\n/opt/anaconda3/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method\n    return getattr(self.get_queryset(), name)(*args, **kwargs)\n/opt/anaconda3/lib/python3.12/site-packages/django/db/models/query.py:1868: in _insert\n    return query.get_compiler(using=using).execute_sql(returning_fields)\n/opt/anaconda3/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql\n    cursor.execute(sql, params)\n/opt/anaconda3/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute\n    return self._execute_with_wrappers(\n/opt/anaconda3/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers\n    return executor(sql, params, many, context)\n/opt/anaconda3/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute\n    with self.db.wrap_database_errors:\n/opt/anaconda3/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__\n    raise dj_exc_value.with_traceback(traceback) from exc_value\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <django.db.backends.utils.CursorWrapper object at 0x10a791280>\nsql = 'INSERT INTO \"knowledge_knowledgedocument\" (\"title\", \"content\", \"summary\", \"doc_type\", \"status\", \"namespace_id\", \"pare...LUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s) RETURNING \"knowledge_knowledgedocument\".\"id\"'\nparams = ('文件夹', None, None, 'folder', 'draft', 11, ...)\nignored_wrapper_args = (False, {'connection': <DatabaseWrapper vendor='postgresql' alias='default'>, 'cursor': <django.db.backends.utils.CursorWrapper object at 0x10a791280>})\n\n    def _execute(self, sql, params, *ignored_wrapper_args):\n        # Raise a warning during app initialization (stored_app_configs is only\n        # ever set during testing).\n        if not apps.ready and not apps.stored_app_configs:\n            warnings.warn(self.APPS_NOT_READY_WARNING_MSG, category=RuntimeWarning)\n        self.db.validate_no_broken_transaction()\n        with self.db.wrap_database_errors:\n            if params is None:\n                # params default might be backend specific.\n                return self.cursor.execute(sql)\n            else:\n>               return self.cursor.execute(sql, params)\nE               django.db.utils.IntegrityError: null value in column \"last_editor_id\" of relation \"knowledge_knowledgedocument\" violates not-null constraint\nE               DETAIL:  Failing row contains (2, 文件夹, null, null, folder, draft, , 0, 0, f, t, 2025-07-28 08:45:53.829413+00, 2025-07-28 08:45:53.82944+00, null, 31, null, 11, null).\n\n/opt/anaconda3/lib/python3.12/site-packages/django/db/backends/utils.py:105: IntegrityError"}, "description": "测试递归删除文档", "start": 1753692353074, "stop": 1753692353932, "uuid": "6c274561-89f3-4ed5-9733-1de5eec112da", "historyId": "f0d953d7141d9f3769dec50103c460dd", "testCaseId": "f0d953d7141d9f3769dec50103c460dd", "fullName": "knowledge.tests.test_knowledge_management.KnowledgeDocumentTestCase#test_delete_document_recursive", "labels": [{"name": "tag", "value": "django_db"}, {"name": "parentSuite", "value": "knowledge.tests"}, {"name": "suite", "value": "test_knowledge_management"}, {"name": "subSuite", "value": "KnowledgeDocumentTestCase"}, {"name": "host", "value": "zongjunyi.local"}, {"name": "thread", "value": "49126-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "knowledge.tests.test_knowledge_management"}]}