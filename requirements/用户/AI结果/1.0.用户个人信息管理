ç”¨æˆ·ç®¡ç†ç³»ç»Ÿæ‰©å±•åŠŸèƒ½æ€»ç»“
æˆ‘å·²ç»æˆåŠŸåœ¨ç°æœ‰çš„ç”¨æˆ·ç™»å½•å’Œä¸ªäººä¿¡æ¯ç®¡ç†åŸºç¡€ä¸Šï¼Œå®ç°äº†å®Œæ•´çš„ç”¨æˆ·ç®¡ç†åŠŸèƒ½ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†çš„åŠŸèƒ½æ¸…å•ï¼š
ğŸ”§ æ ¸å¿ƒæ‰©å±•
1. ç”¨æˆ·æ¨¡å‹æ‰©å±• (user/models/user.py)
âœ… æ·»åŠ äº†è§’è‰²å­—æ®µï¼ˆæ™®é€šç”¨æˆ·/ç®¡ç†å‘˜ï¼‰
âœ… æ·»åŠ äº†æ€§åˆ«å­—æ®µï¼ˆç”·æ€§/å¥³æ€§/æœªçŸ¥ï¼‰
âœ… æ·»åŠ äº†ç”Ÿæ—¥å­—æ®µ
âœ… æ·»åŠ äº†å¹´é¾„è®¡ç®—å±æ€§ï¼ˆæ ¹æ®ç”Ÿæ—¥è‡ªåŠ¨è®¡ç®—ï¼‰
âœ… æ·»åŠ äº† is_admin å±æ€§ç”¨äºæƒé™åˆ¤æ–­
âœ… ä¿ç•™äº†åŸæœ‰çš„æ‰€æœ‰å­—æ®µï¼ˆphoneã€avatarã€is_activeç­‰ï¼‰
2. æƒé™ç³»ç»Ÿ (user/permissions.py)
âœ… IsAdminUser: ä»…ç®¡ç†å‘˜å¯è®¿é—®çš„æƒé™ç±»
âœ… IsOwnerOrAdmin: èµ„æºæ‰€æœ‰è€…æˆ–ç®¡ç†å‘˜å¯è®¿é—®çš„æƒé™ç±»
ğŸ¯ ç®¡ç†å‘˜ä¸“ç”¨åŠŸèƒ½
3. ç”¨æˆ·ç®¡ç†CRUDæ¥å£ (user/views/user.py - UserManagementViewSet)
âœ… è·å–ç”¨æˆ·åˆ—è¡¨: GET /user/admin/management/
âœ… è·å–ç”¨æˆ·è¯¦æƒ…: GET /user/admin/management/{id}/
âœ… åˆ›å»ºæ–°ç”¨æˆ·: POST /user/admin/management/
âœ… æ›´æ–°ç”¨æˆ·ä¿¡æ¯: PUT /user/admin/management/{id}/
âœ… åˆ é™¤ç”¨æˆ·: DELETE /user/admin/management/{id}/
4. é«˜çº§ç®¡ç†åŠŸèƒ½
âœ… åˆ‡æ¢ç”¨æˆ·çŠ¶æ€: POST /user/admin/management/{id}/toggle_status/
âœ… é‡ç½®ç”¨æˆ·å¯†ç : POST /user/admin/management/{id}/reset_password/
âœ… ç®¡ç†ç”¨æˆ·å¤´åƒ:
POST /user/admin/management/{id}/upload_avatar/
DELETE /user/admin/management/{id}/delete_avatar/
5. æœç´¢å’Œæ’åºåŠŸèƒ½
æ”¯æŒçš„æœç´¢å­—æ®µï¼š
âœ… ç”¨æˆ·åï¼ˆæ¨¡ç³Šæœç´¢ï¼‰
âœ… æ‰‹æœºå·ï¼ˆæ¨¡ç³Šæœç´¢ï¼‰
âœ… é‚®ç®±ï¼ˆæ¨¡ç³Šæœç´¢ï¼‰
âœ… æ€§åˆ«ï¼ˆç²¾ç¡®åŒ¹é…ï¼‰
âœ… è§’è‰²ï¼ˆç²¾ç¡®åŒ¹é…ï¼‰
âœ… æ˜¯å¦æœ‰æ•ˆï¼ˆå¸ƒå°”å€¼ï¼‰
âœ… ç”¨æˆ·IDï¼ˆç²¾ç¡®åŒ¹é…ï¼‰
æ”¯æŒçš„æ’åºå­—æ®µï¼š
âœ… åˆ›å»ºæ—¶é—´ï¼ˆå‡åº/é™åºï¼‰
âœ… ä¸Šæ¬¡ç™»å½•æ—¶é—´ï¼ˆå‡åº/é™åºï¼‰
âœ… æ³¨å†Œæ—¶é—´ï¼ˆå‡åº/é™åºï¼‰
ğŸ”’ å®‰å…¨å’Œæƒé™
6. æƒé™æ§åˆ¶
âœ… æ™®é€šç”¨æˆ·æ— æ³•è®¿é—®ä»»ä½•ç®¡ç†æ¥å£
âœ… åªæœ‰ç®¡ç†å‘˜å¯ä»¥è¿›è¡Œç”¨æˆ·ç®¡ç†æ“ä½œ
âœ… å®Œæ•´çš„æƒé™éªŒè¯å’Œé”™è¯¯å¤„ç†
7. æ•°æ®éªŒè¯
âœ… ç”¨æˆ·åé‡å¤æ£€æŸ¥ï¼ˆåˆ›å»ºå’Œæ›´æ–°æ—¶ï¼‰
âœ… å¯†ç å¼ºåº¦éªŒè¯ï¼ˆæœ€å°‘8ä½ï¼‰
âœ… å¤´åƒæ–‡ä»¶æ ¼å¼å’Œå¤§å°éªŒè¯
âœ… å¿…è¦å­—æ®µéªŒè¯
ğŸ“Š APIæ–‡æ¡£å’Œåºåˆ—åŒ–å™¨
8. å®Œæ•´çš„åºåˆ—åŒ–å™¨ (user/serializers/user.py)
âœ… UserManagementSerializer: ç®¡ç†å‘˜æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯
âœ… UserCreateSerializer: ç®¡ç†å‘˜åˆ›å»ºç”¨æˆ·
âœ… UserUpdateSerializer: ç®¡ç†å‘˜æ›´æ–°ç”¨æˆ·
âœ… PasswordResetSerializer: å¯†ç é‡ç½®
âœ… UserSearchSerializer: æœç´¢å‚æ•°éªŒè¯
âœ… å„ç§å“åº”åºåˆ—åŒ–å™¨ç”¨äºAPIæ–‡æ¡£
9. æ›´æ–°çš„ç”¨æˆ·ä¿¡æ¯åºåˆ—åŒ–å™¨
âœ… æ‰©å±•äº† UserInfoSerializer åŒ…å«æ–°å­—æ®µï¼ˆè§’è‰²ã€æ€§åˆ«ã€ç”Ÿæ—¥ã€å¹´é¾„ï¼‰
âœ… æ›´æ–°äº† UserUpdateProfileSerializer æ”¯æŒæ€§åˆ«å’Œç”Ÿæ—¥æ›´æ–°
ğŸ›£ï¸ URLè·¯ç”±
10. è·¯ç”±é…ç½® (user/urls.py)
æ™®é€šç”¨æˆ·æ¥å£: /user/
- /user/login/
- /user/logout/
- /user/profile/
- /user/update_profile/
- /user/register/
- /user/upload_avatar/
- /user/delete_avatar/

ç®¡ç†å‘˜æ¥å£: /user/admin/management/
- GET /user/admin/management/ (åˆ—è¡¨)
- POST /user/admin/management/ (åˆ›å»º)
- GET /user/admin/management/{id}/ (è¯¦æƒ…)
- PUT /user/admin/management/{id}/ (æ›´æ–°)
- DELETE /user/admin/management/{id}/ (åˆ é™¤)
- POST /user/admin/management/{id}/toggle_status/ (åˆ‡æ¢çŠ¶æ€)
- POST /user/admin/management/{id}/reset_password/ (é‡ç½®å¯†ç )
- POST /user/admin/management/{id}/upload_avatar/ (ä¸Šä¼ å¤´åƒ)
- DELETE /user/admin/management/{id}/delete_avatar/ (åˆ é™¤å¤´åƒ)

ğŸ§ª æµ‹è¯•è¦†ç›–
11. å…¨é¢çš„æµ‹è¯•ç”¨ä¾‹ (user/tests/test_user.py)
âœ… 35ä¸ªæµ‹è¯•ç”¨ä¾‹
âœ… ç”¨æˆ·è®¤è¯æµ‹è¯•ï¼ˆç™»å½•ã€ç™»å‡ºã€æ³¨å†Œã€ä¸ªäººä¿¡æ¯ç®¡ç†ï¼‰
âœ… ç”¨æˆ·ç®¡ç†åŠŸèƒ½æµ‹è¯•ï¼ˆCRUDã€æœç´¢ã€æ’åºã€æƒé™ï¼‰
âœ… æƒé™éªŒè¯æµ‹è¯•ï¼ˆæ™®é€šç”¨æˆ·æ— æ³•è®¿é—®ç®¡ç†æ¥å£ï¼‰
âœ… æ•°æ®éªŒè¯æµ‹è¯•ï¼ˆé‡å¤ç”¨æˆ·åã€å¯†ç é‡ç½®ç­‰ï¼‰
âœ… æ¨¡å‹å±æ€§æµ‹è¯•ï¼ˆå¹´é¾„è®¡ç®—ã€ç®¡ç†å‘˜åˆ¤æ–­ï¼‰
ğŸ—ƒï¸ æ•°æ®åº“
12. æ•°æ®åº“è¿ç§»
âœ… åˆ›å»ºäº†è¿ç§»æ–‡ä»¶æ·»åŠ æ–°å­—æ®µ
âœ… æˆåŠŸåº”ç”¨äº†æ•°æ®åº“è¿ç§»
âœ… æ”¯æŒç°æœ‰æ•°æ®çš„å…¼å®¹æ€§
ğŸ› ï¸ ç®¡ç†å·¥å…·
13. ç®¡ç†å‘½ä»¤ (user/management/commands/create_admin.py)
# åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·
python manage.py create_admin --username admin --email admin@example.com --password admin123

ğŸ¨ åŠŸèƒ½ç‰¹ç‚¹
14. ç”¨æˆ·ä½“éªŒ
âœ… æ”¯æŒåˆ†é¡µï¼ˆé»˜è®¤15æ¡/é¡µï¼‰
âœ… çµæ´»çš„æœç´¢å’Œè¿‡æ»¤
âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
âœ… ç»Ÿä¸€çš„APIå“åº”æ ¼å¼
âœ… è¯¦ç»†çš„APIæ–‡æ¡£ï¼ˆSwagger/OpenAPIï¼‰
15. æ‰©å±•æ€§
âœ… æ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºç»´æŠ¤
âœ… å®Œæ•´çš„æƒé™ä½“ç³»ï¼Œå¯æ‰©å±•æ›´å¤šè§’è‰²
âœ… åºåˆ—åŒ–å™¨åˆ†ç¦»ï¼Œä¾¿äºAPIç‰ˆæœ¬ç®¡ç†
âœ… å®Œå–„çš„æµ‹è¯•è¦†ç›–ï¼Œä¿è¯ä»£ç è´¨é‡
ğŸ“‹ ä½¿ç”¨ç¤ºä¾‹
# åˆ›å»ºç®¡ç†å‘˜
python manage.py create_admin

# è¿è¡Œæµ‹è¯•
python manage.py test user.tests.test_user

# åº”ç”¨è¿ç§»
python manage.py migrate user